1. When a user takes a picture, that picture is stored in a path based on the given URI. In which part of the code handles this? (Copy that part of the code as the answer)

ANSWER:
-------
// From MainActivity.kt - Activity result launcher registration
takePictureLauncher =
    registerForActivityResult(ActivityResultContracts.TakePicture()) {
        providerFileManager.insertImageToStore(photoInfo)
    }

// From ProviderFileManager.kt - The insertToStore method
private fun insertToStore(
    fileInfo: FileInfo,
    contentUri: Uri,
    contentValues: ContentValues
) {
    executor.execute {
        val insertedUri = contentResolver.insert(contentUri, contentValues)
        insertedUri?.let {
            val inputStream = contentResolver.openInputStream(fileInfo.uri)
            val outputStream = contentResolver.openOutputStream(insertedUri)
            IOUtils.copy(inputStream, outputStream)
        }
    }
}

Explanation: The ActivityResultContracts.TakePicture() contract automatically saves the captured image to the URI that was passed to takePictureLauncher.launch(uri), and then the callback triggers insertImageToStore() to copy it to MediaStore.


2. In your FileInfo.kt, there are 5 attributes. On the first attribute, what does the URI refer to? And on the fourth attribute, what does relativePath refer to?

ANSWER:
-------
First attribute - uri: Uri

This URI refers to the temporary FileProvider URI that points to the file location in the app's private external storage directory. It's generated by FileProvider.getUriForFile() and is used to grant temporary access to the camera app to save the captured photo/video. 

This URI points to a location like:
content://com.example.lab_week_11_b.camera/photos/img_1234567890.jpg

Which maps to the actual file path:
/storage/emulated/0/Android/data/com.example.lab_week_11_b/files/Pictures/img_1234567890.jpg


Fourth attribute - relativePath: String

This refers to the relative path within the MediaStore where the file will be permanently stored after being copied from the temporary location. It specifies the folder name in the public shared storage, such as:
- Environment.DIRECTORY_PICTURES (which resolves to "Pictures") for images
- Environment.DIRECTORY_MOVIES (which resolves to "Movies") for videos

This path is used in the ContentValues when inserting into MediaStore, so the file appears in the Gallery app under the appropriate folder.


3. [Bonus] Explain the chronological order from when a user takes a picture until the file is stored in the MediaStore.

ANSWER:
-------

Step 1: User clicks Photo button
- findViewById<Button>(R.id.photo_button).setOnClickListener is triggered
- checkStoragePermission() verifies storage permissions (for Android 9 and below)

Step 2: Generate temporary file URI
- openImageCapture() is called
- providerFileManager.generatePhotoUri(System.currentTimeMillis()) creates a FileInfo object containing:
  * A temporary file in app-specific storage: /Android/data/com.example.lab_week_11_b/files/Pictures/img_[timestamp].jpg
  * A FileProvider URI pointing to that file
  * Metadata (name, relativePath, mimeType)

Step 3: Launch camera with URI
- takePictureLauncher.launch(uri) launches the camera app
- The URI is passed to the camera app via ActivityResultContracts.TakePicture()
- Camera app is granted temporary permission to write to this URI

Step 4: Camera captures and saves
- User takes the photo
- Camera app automatically saves the image to the provided FileProvider URI location
- The file is now stored in: /Android/data/com.example.lab_week_11_b/files/Pictures/img_[timestamp].jpg

Step 5: Activity result callback
- Camera app returns success result
- registerForActivityResult(ActivityResultContracts.TakePicture()) callback is triggered
- providerFileManager.insertImageToStore(photoInfo) is called

Step 6: Copy to MediaStore
- insertImageToStore() calls insertToStore() on a background executor thread
- mediaContentHelper.getImageContentUri() gets the appropriate MediaStore URI (different for Android 10+ vs Android 9-)
- mediaContentHelper.generateImageContentValues(fileInfo) creates ContentValues with file metadata (name, relativePath, mimeType)
- contentResolver.insert(contentUri, contentValues) creates a new entry in MediaStore and returns a new URI

Step 7: File data transfer
- contentResolver.openInputStream(fileInfo.uri) opens input stream from the temporary file
- contentResolver.openOutputStream(insertedUri) opens output stream to the MediaStore location
- IOUtils.copy(inputStream, outputStream) copies the actual image data from temporary storage to MediaStore

Step 8: File now accessible in Gallery
- The image is now permanently stored in MediaStore
- It appears in the device's Gallery app under the "Pictures" folder
- The original temporary file remains in app-specific storage (could be deleted if needed)

WHY THIS TWO-STEP PROCESS?
This two-step process (temporary storage â†’ MediaStore) ensures that:
- The camera has a reliable place to save the photo immediately
- The app maintains control over when and how the file is added to public MediaStore
- The file is properly indexed and accessible by other apps (like Gallery)